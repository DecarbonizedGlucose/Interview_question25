### 5.全局，静态，局部？？

先想想输出是什么，再运行代码看看对不对！

```c
int x = 5;          
static int y = 20;  

int test(int z) {
    static int x = 100;   
    int y = 50;           

    x += z;
    y += z;

    printf("Inside test: x = %d, y = %d, z = %d\n", x, y, z);
    return x + y + z;
}

int main() {
    int result1 = test(5);
    int result2 = test(10);

    printf("In main: x = %d, y = %d, result1 = %d, result2 = %d\n", x, y, result1, result2);
    return 0;
}

```

------

| **出题人** | **徐子淳**   |
| ---------- | ------------ |
| 知识点1    | 全局变量，局部变量，静态变量 |
| 知识点2    | 作用域，生命周期   |
| 知识点3    | 变量存储区域    |

------

Q1.答案，解释全局变量，局部变量，静态变量 40%

Q2.讲讲各个变量的作用域，生命周期 35%

Q3.变量存储区域 25%

```
A1：

答案：
Inside test: x = 105, y = 55, z = 5
Inside test: x = 115, y = 60, z = 10
In main: x = 5, y = 20, result1 = 165, result2 = 185

- 全局变量：

定义在所有函数之外，整个程序都可以访问。

生命周期为整个程序运行期间，存储在静态存储区。

可以在其他文件通过 extern 引用访问。

- 局部变量：

定义在函数或代码块内部，只能在定义的函数/块内使用。

生命周期从定义开始到函数/块结束，存储在栈区（stack）。

局部变量可以和全局变量同名，局部优先级高。

- 静态变量：

可以修饰全局或局部变量。

静态局部变量：在函数内定义，加 static，作用域仅函数内，但生命周期延长到整个程序运行期间，值会保留。

静态全局变量：作用域限制在当前文件，生命周期为整个程序运行期间。

存储在静态存储区（data/bss 段）。


A2：
全局变量的作用域是整个程序，可以通过 extern 在其他文件访问，生命周期贯穿整个程序。
静态全局变量只在当前文件可见，生命周期也是整个程序。
局部变量只在定义它的函数或代码块内部可用，生命周期随函数或代码块的执行而结束。
静态局部变量作用域在函数内部，但生命周期延长到整个程序运行期间，调用多次值会保留。


A3：

- 全局变量
存储区域: 静态存储区
生命周期: 整个程序运行期间
作用域: 整个程序，可以通过 extern 在其他文件中访问
特点: 初始化的变量存放在 .data 段，未初始化的变量存放在 .bss 段

- 静态全局变量
存储区域: 静态存储区
生命周期: 整个程序运行期间
作用域: 当前文件
特点: 名字私有，避免与其他文件中的同名变量冲突

- 局部变量
存储区域: 栈区
生命周期: 函数调用期间
作用域: 函数/块内部
特点: 每次调用时重新分配内存

- 静态局部变量
存储区域: 静态存储区
生命周期: 整个程序运行期间
作用域: 函数内部
特点: 保留上次调用后的值，多次调用时值会累积

- 动态分配变量
存储区域: 堆区
生命周期: 手动释放（例如使用 free 函数）
作用域: 通过指针访问
特点: 灵活分配，需要程序员手动管理内存


- 静态存储区

data 段：存储已初始化的全局变量

bss 段：存储未初始化的全局变量或初始化为 0 的变量
```
